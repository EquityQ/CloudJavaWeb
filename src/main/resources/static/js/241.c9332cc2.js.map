{"version":3,"file":"js/241.c9332cc2.js","mappings":"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","sources":["webpack://my_cloud_javaweb_project/./src/class/config.js","webpack://my_cloud_javaweb_project/./src/views/shop/CartPage.vue","webpack://my_cloud_javaweb_project/./src/views/shop/CartPage.vue?88e5"],"sourcesContent":["const config = {\r\n    baseUrl: 'http://localhost:8081',\r\n    api: {\r\n        captcha: '/captcha',\r\n        login: '/user/login',\r\n        register: '/user/register',\r\n        logout: '/user/logout',\r\n        getUserInfo: '/user/getinfo',\r\n        authToken:'/user/token-auth',\r\n        ip: '/ip',\r\n        ShopInfo: \"/element/info\",\r\n        code: '/user/code',\r\n        selectUser:\"/user/select-info\",\r\n        deleteUser:\"/user/delete\",\r\n        updateUser:\"/user/change\",\r\n        deleteShop:\"/element/delete\",\r\n        uploadImg:\"/img/base64\",\r\n        updateShop:\"/element/change\",\r\n        insertShop:\"/element/insert\",\r\n    },\r\n    apiUrl: '/api'\r\n}\r\nexport default config","<template>\r\n  <div>\r\n    <el-card class=\"box-card\" style=\"margin-top: 20px\">\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span>购物车</span>\r\n        </div>\r\n      </template>\r\n      <el-table :data=\"cart\" style=\"width: 100%\">\r\n        <el-table-column prop=\"name\" label=\"商品名称\" width=\"180\" />\r\n        <el-table-column prop=\"price\" label=\"单价\" width=\"180\" />\r\n        <el-table-column prop=\"quantity\" label=\"数量\" width=\"180\" />\r\n        <el-table-column prop=\"localtotal\" label=\"小计\" width=\"180\" />\r\n        <el-table-column label=\"操作\">\r\n          <template #default=\"scope\">\r\n            <el-button size=\"medium\" @click=\"removeFromCart(scope.row)\">删除</el-button>\r\n            <el-input-number style=\"margin-left: 20px\" v-model=\"scope.row.quantity\" :min=\"1\" :max=\"100\" label=\"数量\" @change=\"updateQuantity(scope.row)\" />\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <div class=\"total\">\r\n        <strong>总价: ￥{{ total }}</strong>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport config from \"@/class/config\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      cart: [],\r\n      total: 0\r\n    }\r\n  },\r\n  mounted() {\r\n    var token = this.$cookies.get(\"token\");\r\n    if(token==null&&token==\"\"){\r\n      this.$message.error(\"未检测到登录态,无法使用购物车功能。\");\r\n      this.$cookies.remove(\"token\");\r\n      this.$router.push(\"/user/login\");\r\n      return;\r\n    }\r\n  //   扫描所有cookie 除了token 与permission\r\n    this.$axios.get(config.baseUrl+config.apiUrl+config.api.ShopInfo,{}).then(res=>{\r\n      if(res.data.Code===200){\r\n        for (var i=0;i<res.data.elements.length;i++){\r\n          if(this.$cookies.get(res.data.elements[i].name)!=null){\r\n            this.cart.push({ name: res.data.elements[i].name, price: res.data.elements[i].price, quantity: this.$cookies.get(res.data.elements[i].name), localtotal: res.data.elements[i].price*this.$cookies.get(res.data.elements[i].name),maxValue: res.data.elements[i].value });\r\n            this.total += parseFloat(res.data.elements[i].price*this.$cookies.get(res.data.elements[i].name));\r\n          }\r\n        }\r\n      }else{\r\n        this.$message.error(res.data.Response);\r\n      }\r\n    })\r\n\r\n  },\r\n  methods: {\r\n    removeFromCart(item) {\r\n      var token = this.$cookies.get(\"token\");\r\n      if(token==null&&token==\"\"){\r\n        this.$message.error(\"未检测到登录态,无法使用购物车功能。\");\r\n        this.$cookies.remove(\"token\");\r\n        this.$router.push(\"/user/login\");\r\n        return;\r\n      }\r\n      this.$cookies.remove(item.name);\r\n    //   刷新页面\r\n      this.$router.go(0);\r\n    },\r\n    updateQuantity(item) {\r\n      var token = this.$cookies.get(\"token\");\r\n      if(token==null&&token==\"\"){\r\n        this.$message.error(\"未检测到登录态,无法使用购物车功能。\");\r\n        this.$cookies.remove(\"token\");\r\n        this.$router.push(\"/user/login\");\r\n        return;\r\n      }\r\n      if(item.quantity>item.maxValue){\r\n        this.$message.error(\"商品库存不足,无法继续添加。\");\r\n        item.quantity = item.maxValue;\r\n        return;\r\n      }\r\n    //   直接修改cookie\r\n      this.$cookies.set(item.name,item.quantity,{path:\"/\",expires:30});\r\n    //   更新数据\r\n      this.total = item.quantity*item.price;\r\n      for (var i=0;i<this.cart.length;i++){\r\n        if(this.cart[i].name===item.name){\r\n          this.cart[i].quantity = item.quantity;\r\n          this.cart[i].localtotal = item.quantity*item.price;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.total {\r\n  text-align: right;\r\n  margin-top: 10px;\r\n  font-size: 18px;\r\n}\r\n</style>\r\n","import { render } from \"./CartPage.vue?vue&type=template&id=0402eff7&scoped=true\"\nimport script from \"./CartPage.vue?vue&type=script&lang=js\"\nexport * from \"./CartPage.vue?vue&type=script&lang=js\"\n\nimport \"./CartPage.vue?vue&type=style&index=0&id=0402eff7&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-0402eff7\"]])\n\nexport default __exports__"],"names":["config","baseUrl","api","captcha","login","register","logout","getUserInfo","authToken","ip","ShopInfo","code","selectUser","deleteUser","updateUser","deleteShop","uploadImg","updateShop","insertShop","apiUrl","class","_createElementBlock","_createVNode","_component_el_card","style","header","_withCtx","_cache","_createElementVNode","default","_component_el_table","data","$data","cart","_component_el_table_column","prop","label","width","scope","_component_el_button","size","onClick","$event","$options","removeFromCart","row","_createTextVNode","_","_component_el_input_number","modelValue","quantity","min","max","onChange","updateQuantity","_hoisted_1","_toDisplayString","total","mounted","token","this","$cookies","get","$message","error","remove","$router","push","$axios","then","res","Code","i","elements","length","name","price","localtotal","maxValue","value","parseFloat","Response","methods","item","go","set","path","expires","__exports__","render"],"sourceRoot":""}