"use strict";(self["webpackChunkmy_cloud_javaweb_project"]=self["webpackChunkmy_cloud_javaweb_project"]||[]).push([[346],{1764:function(e,a){const t={baseUrl:"http://localhost:8081",api:{captcha:"/captcha",login:"/user/login",register:"/user/register",logout:"/user/logout",getUserInfo:"/user/getinfo",authToken:"/user/token-auth",ip:"/ip",ShopInfo:"/element/info",code:"/user/code",selectUser:"/user/select-info",deleteUser:"/user/delete",updateUser:"/user/change",deleteShop:"/element/delete",uploadImg:"/img/base64",updateShop:"/element/change",insertShop:"/element/insert",getOrders:"/order/getall",payInsert:"/pay/top-up",payMyinfo:"/pay/get",payEx:"/pay/exchange"},apiUrl:"/api"};a.A=t},6346:function(e,a,t){t.r(a),t.d(a,{default:function(){return m}});var o=t(6768),s=t(4232);const r={style:{"text-align":"center"}},l=["src"],u={key:1,class:"el-icon-plus avatar-uploader-icon"};function d(e,a,t,d,i,p){const n=(0,o.g2)("el-upload"),c=(0,o.g2)("el-form-item"),h=(0,o.g2)("el-input"),m=(0,o.g2)("el-button"),g=(0,o.g2)("el-form");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("h2",r,"当前正在修改的商品："+(0,s.v_)(i.Shopname),1),(0,o.bF)(g,{"label-width":"100px",model:i.product},{default:(0,o.k6)((()=>[(0,o.bF)(c,{label:"商品图片"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{class:"avatar-uploader",action:p.config.baseUrl+p.config.apiUrl+p.config.api.uploadImg,"show-file-list":!1,"on-success":p.handleAvatarSuccess,"before-upload":p.beforeAvatarUpload},{default:(0,o.k6)((()=>[i.product.image?((0,o.uX)(),(0,o.CE)("img",{key:0,src:i.product.image,class:"avatar"},null,8,l)):((0,o.uX)(),(0,o.CE)("i",u))])),_:1},8,["action","on-success","before-upload"])])),_:1}),(0,o.bF)(c,{label:"商品名称"},{default:(0,o.k6)((()=>[(0,o.bF)(h,{modelValue:i.product.name,"onUpdate:modelValue":a[0]||(a[0]=e=>i.product.name=e),placeholder:"请输入商品名称"},null,8,["modelValue"])])),_:1}),(0,o.bF)(c,{label:"商品价格"},{default:(0,o.k6)((()=>[(0,o.bF)(h,{modelValue:i.product.price,"onUpdate:modelValue":a[1]||(a[1]=e=>i.product.price=e),modelModifiers:{trim:!0},placeholder:"请输入商品价格"},null,8,["modelValue"])])),_:1}),(0,o.bF)(c,{label:"商品库存"},{default:(0,o.k6)((()=>[(0,o.bF)(h,{modelValue:i.product.value,"onUpdate:modelValue":a[2]||(a[2]=e=>i.product.value=e),modelModifiers:{number:!0},placeholder:"请输入商品库存"},null,8,["modelValue"])])),_:1}),(0,o.bF)(c,{label:"商品描述"},{default:(0,o.k6)((()=>[(0,o.bF)(h,{modelValue:i.product.description,"onUpdate:modelValue":a[3]||(a[3]=e=>i.product.description=e),type:"textarea",placeholder:"请输入商品描述"},null,8,["modelValue"])])),_:1}),(0,o.bF)(c,null,{default:(0,o.k6)((()=>[(0,o.bF)(m,{type:"primary",onClick:p.handleSubmit},{default:(0,o.k6)((()=>a[4]||(a[4]=[(0,o.eW)("提交")]))),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])],64)}t(4114);var i=t(1764),p=t(1387),n={name:"ShopUpdate",computed:{config(){return i.A}},mounted(){const e=(0,p.lq)();if(this.Shopname=e.query.name,null==this.Shopname||""===this.Shopname)return this.$message.error("获取商品信息失败"),void this.$router.push("/dashboard");this.$axios.get(i.A.baseUrl+i.A.apiUrl+i.A.api.ShopInfo,{}).then((e=>{if(200===e.data.Code){for(var a=0;a<e.data.elements.length;a++)if(e.data.elements[a].name===this.Shopname){this.product=e.data.elements[a];break}}else this.$message.error(e.data.Response),this.$router.push("/dashboard")}))},data(){return{Shopname:"",product:{name:"",price:"",value:"",description:"",image:""}}},methods:{handleSubmit(){/^[0-9]+(.[0-9]{1,2})?$/.test(this.product.price)?this.$axios.post(i.A.baseUrl+i.A.apiUrl+i.A.api.updateShop,{name:this.product.name,price:this.product.price,value:this.product.value,description:this.product.description,image:this.product.image,oldName:this.Shopname},{headers:{token:this.$cookies.get("token")}}).then((e=>{200===e.data.Code?(this.$message.success(e.data.Response),this.$router.push("/dashboard")):this.$message.error(e.data.Response)})):this.$message.error("商品价格参数不合法")},beforeAvatarUpload(e){const a="image/jpeg"===e.type,t=e.size/1024/1024<2;return a||this.$message.error("上传头像图片只能是 JPG 格式!"),t||this.$message.error("上传头像图片大小不能超过 2MB!"),a&&t},handleAvatarSuccess(e){200===e.Code?(this.product.image=e.base64,this.$message.success(e.Response)):this.$message.error(e.Response)}}},c=t(1241);const h=(0,c.A)(n,[["render",d],["__scopeId","data-v-0bc9271f"]]);var m=h}}]);
//# sourceMappingURL=346.fe274e3c.js.map